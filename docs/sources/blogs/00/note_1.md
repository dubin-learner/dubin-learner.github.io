# 优化系列（程序喵）笔记 - 第二篇 代码效率分析（1）

这是一篇针对[目标文章](https://mp.weixin.qq.com/s/i7V6lmtQpuFADYZ8ApmkWA)的笔记。

> 本专题将分析C++各种代码操作的效率，包括不同类型变量的存储效率，使用智能指针、循环、函数参数、虚函数、数组等的效率，以及如何做针对性优化，或选择更有效的替代方案。

该文章为第二篇的第一部分，将聚焦以下几个部分。

## 变量存储区域

> 在C++中，变量存储在哪类内存，取决于开发者声明它们的方式。如果数据不连续，分成无数段分散在内存中，会降低数据的Cache命中率。因此，理解变量如何存储非常重要。

分散的变量会降低数据的Cache命中率：Cache中保存的是最近使用的、或者循环使用的内存数据，如果数据过于分散，在运行时一部分不在Cache中（命中率降低），则要去内存中读取数据，降低运行速度。

在内存中，变量可能存在的位置有：栈、全局或静态空间、堆。

### 全局或静态空间

> 静态空间的优点是，可以在程序启动前就将其初始化为所需的值。缺点是，即使变量只使用一次，或者只在程序的一小部分中使用，它的内存，也会在程序整个运行过程中被占用，会降低Cache的效率。

所以尽量不要使用全局变量；
