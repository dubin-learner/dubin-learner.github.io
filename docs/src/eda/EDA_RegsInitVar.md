# 寄存器上电初值

最近的工作中，*chenmeng*发现了一种特定的FF与Gate的连接，能被优化掉。在写unit-case进行测试的过程中，对寄存器默认的初值始终有些不明白，于是查找了相关的文章补充了一下。

一般来说，如果通过实例化FF单元的方式来生成寄存器的话，其默认的初值为0；也可以通过指定INIT属性来直接设置初值。如果是通过硬件描述语言的always语句来生成寄存器的话，可以通过设置输出wire的初始值作为寄存器的初值。如果未指定，默认的初值也可以认为是0，取决于综合工具。

根据参考文章中的观点，如果寄存器有异步清零端，则上电初值为0；有异步置位端，则上电初值为1。对于较复杂的always语句，多个信号可作为异步控制端的情况下，如果infer出异步清零，则上电初值为0；如果infer出异步置位，则上电初值为1。简单的情况下默认为0。

如果寄存器特定的连接方式导致其输出为常数，那么考虑优化掉该寄存器时一定要看其初值是否与最终输出一致，如果一致则可以优化，否则不行。

在测试unit-case进行仿真验证时，使用Vivado自带的仿真工具，但遇到了修改代码后波形不变的问题。开始一直以为是自己代码有问题，查了半天不得要领。后来搜索后发现，一旦波形修改重新仿真的话，需要重置Vivado的仿真工具才行（Reset Run Simulation）。

## 参考文章
1. [FPGA寄存器的上电初值](http://xilinx.eetrend.com/d6-xilinx/blog/2012-08/2966.html)
2. [Vivado行为仿真，修改代码后波形不变的问题](https://blog.csdn.net/WYH19951010/article/details/106072170)
